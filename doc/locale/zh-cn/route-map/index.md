# 路线图

`ui-designer` 纯碎是一个业余项目，主要是为了验证自己的想法能否成功实现。路线图方面，大体规划如下

## V0.1 基础设施搭建

在这个版本阶段，主要解决一些基础设施问题，包括但不限于：


- 研究学习，并思考如何抽象不同平台上所定义的一系列交互概念？
- 整体架构设计


**TODO**

No content

**DONE**


- 完成Action类型设计[ok]
- 完成EventHandler类型设计 [ok]
    - 定义operator,expression等类型。完善其内部实现
- 完成runtime里的序列化、反序列化方法实现
    - 序列化 [ok]
    - 反序列化 [ok]
        - 解决Object,UIObject,以及对应EventHandler信息的序列化、反序列化问题
        - 2
- 测试用例
    - 枚举类型系统测试
    - 类型系统，序列化、反序列化测试
    - expression,operator系统测试


## V0.2 交互模式核心层搭建

在这个阶段，需要构建出整体的、经过抽象后的中间交互核心层的类型体系。

抛开各平台的引擎实现，这一层交互层概念模型是绝对的核心，它既要非常精简，又必须非常灵活，可以实现95%甚至100%的当前已知其他平台希望实现的功能。

在这个阶段，还需要完成`所见即所得编辑器开发和完善`

- 如何实现强类型对象的序列化，以及减少重复的默认属性序列化带来的额外开销。
- 序列化之后的字符串，需要考虑在下一阶段的引擎层面，如何能够正确的反序列化，从而构建起整个应用


### 详细计划

- 编辑器的对象树开发
  - [`已完成`]完成对象树组件开发，可以读取json格式的对象元数据，并且树形结构呈现在组件内部
  - 对象树和可视化区域的协调
  - [`已完成`]stage对象和行为定义
  - [`已完成`]page对象和行为定义
  - [`已完成`]给对象的浏览、展开折叠、删除增加键盘快捷键支持
  - 让对象树的对象支持多选、拖动操作（可以拖动到对象树任意位置）
- 左侧工具箱开发
  - [`已完成`]列表展示所有可用的工具
  - [`已完成`]根据当前用户选择的对象，列出可以使用的工具(`可点击`)
  - [`已完成`]选择工具之后，修改state里的当前选择状态，和选择模式
  - [`已完成`]完成矩形工具开发
  - [`已完成`]完成图片工具开发
  - [`已完成`]完成page工具开发
    - [`已完成`]设计器里的属性需要屏蔽一些不可更改的属性
  - [`已完成`]完成UI容器工具开发
    - 父元素必须也是UI容器元素（比如page或者UI容器）
  - [`已完成`]完成圆形工具开发
  - [`已完成`]完成线条工具开发
  - [`已完成`]完成文本工具开发
  - [`已完成`]完成单行文本输入框工具开发
  - [`已完成`]完成多行文本输入框工具开发
  - 完成容器工具开发
    - 父元素可以是任何容器类元素
  - 完成音频工具开发
  - 完成视频工具开发
- 通用属性面板开发
  - [`已完成`]属性面板的布局
  - 给编辑器的属性item配置增加tooltip字段，如果配置了该字段，则编辑器显示字段旁边增加`感叹号`标识，鼠标移入可以显示更加详细的属性说明
  - [`进行中`]面板中不同数据类型的处理逻辑和UI控件
    - [`已完成`]文本组件功能
    - [`进行中`]数字输入框功能
      - [`已完成`]数字输入框样式定制
      - [`进行中`]数字输入框支持单位和控制框轮流展示
    - [`已完成`]slider组件功能
    - [`已完成`]组件绑定值同步功能
    - [`已完成`]颜色选择框
    - [`已完成`]文件上传框
    - [`已完成`]文本展示、文本输入相关组件的属性面板开发
      - [`已完成`]多行文本编辑属性工具
      - [`已完成`]字体下拉框
- [`进行中`]中间可视化布局区域开发
  - [`已完成`]背景网格图
    - [`已完成`]支持缩放控制
  - [`进行中`]在网格中渲染整个对象树，并且对象可以拖拽
    - [`已完成`]UDPage组件代理编写
    - [`已完成`]UDRectangle组件代理编写
      - [`已完成`]位置形状、背景色
      - [`已完成`]3D旋转，边框和阴影
      - [`已完成`]可以拖拽改变位移、高宽
    - [`已完成`]UDLine 组件代理编写
    - [`已完成`]UDCircle 组件代理编写
    - [`已完成`]UDImage 组件代理编写
    - [`已完成`]UDUIContainer 组件代理编写
    - [`已完成`]UDText 组件代理编写
    - [`进行中`]UDInput 组件代理编写
    - [`进行中`]UDMultiInput 组件代理编写
  
- 事件面板开发 & 组件事件完善
  - 事件面板编辑器开发
  - 所有控件事件完善(需要考虑事件设计的合理性，工作量较大)
    - Stage
    - Page
    - Container
    - UIContainer
    - Rect
    - Circle
    - Image
    - Text
    - Input
    - ...

- 与`舞台`项目不同，新开发`高阶组件`模块
  - 高阶组件设计理念:
    - 仍然是非编程方式，在`ui-design`设计层面支持可视化编写`高阶组件`
    - 高阶组件可以共享出去，其他用户可以在`舞台类标准项目`中使用这些组件
    - 高阶组件开发者，可以选择只暴露必要的属性、事件、行为给使用者(简化使用门槛)
    - 高阶组件被其他stage引入的时候，可以直接把组件的对象`子树`插入到目标parent下面。就好像powerpoint里的group概念一样
  - 高阶组件开发需要用到的特殊控件:(高阶组件开发者使用这些控件完成更复杂多样的业务逻辑和操作)
    - 代码控件
    - 接口调用控件
    - 数据库控件
    - 其他...
- 考虑`开发自定义组件`的设计和实现
  - 设计理念:
    - `开发者自定义组件`和`高阶组件`区别：
      - `高阶组件`本质上仍然运行在`ui-designer`的模式内，只不过是含有逻辑、预设参数的包装后的若干个基本组件的集合
      - `开发者自定义组件`实际上是遵循了一定协议下的、允许开发者上传自己的代码模块的外部组件
      - `开发者自定义组件`牺牲了性能、和领域代码的复用，带来更大外部侵入性。但是极端场景下可能更加符合业务的接入方式
  - 细节...
- 特殊属性面板开发
  - 时间轴面板

- 遗留问题解决
  - Page等可视容器的高度、宽度，是否要支持`自动撑开`属性
    - 背景
      - 当前的Page,Container等，高度宽度都是要固定设置的，虽然支持内容的Clip和滚动，但是容器本身的高度和宽度是需要事先定义好的。
      - 一般情况下是没有问题，但是遇到一些复杂的场景，比如需要请求服务端数据列表，然后动态渲染一个长列表，这时候需要支持动态的高度和宽度

  - 增加对各种字体配置的支持（以及引擎需要考虑app里用到的外部字体问题）
## V0.3 移动端HTML5引擎设计和开发

创建`ui-designer`这个项目，最开始是为了解决移动H5开发的问题。在交互模型核心定型之后，进行移动端引擎开发是最合适不过了。

这个阶段需要明确引擎开发、用户自定义组件开发的范式。主要需要考虑一个问题：
> 一个交互组件，在编辑器端，和在实际运行环境中，都要能有一致性的表现，如何解决重复开发量的问题。(即无论开发什么平台的引擎组件，都需要一个web编辑器端的渲染器，否则无法可视化编辑)

>实现引擎需要考虑，如何通过可视化编辑平台提供的序列化后的配置信息，在引擎层面反序列化加载完整的应用 


## V0.3.1 元素的属性面板，支持直接输入`sketch`或者`蓝湖`的属性字符串

很多在线工具可以浏览UI设计产物的属性，比如：

![蓝湖](./res/lanhu-1.png)

考虑支持在属性面板中允许用户粘贴这些字符串，然后自动解析为可识别的属性。

## V0.3.2 支持导入PS的项目文件，自动创建页面结构

- 调研PS软件的数据文件格式
- 开发相应功能，使得编辑器可以导入并且分析PS数据文件，创建对应的页面结构，并自动设置相关元素的属性

## V0.3.3 支持导入手绘的图纸，自动创建页面结构

调研是否可以支持用户导入手绘原型，直接在编辑器里给用户生成一个页面。用户只需要在生成好的页面上做一些调整即可。

使用的图片->html的技术，可参考:
- [这篇文章](https://blog.insightdatascience.com/automated-front-end-development-using-deep-learning-3169dd086e82)
- [sketch-code项目](https://github.com/ashnkumar/sketch-code)

## V0.4 小程序端引擎设计和开发

完成小程序端的引擎开发

## V0.5 android端引擎设计和开发

## V0.6 iOS端引擎设计和开发

## V0.7 内置领域对象、交互模型完善和迭代

完善一些功能，比如：
- 状态对象
    - 可以定义app的状态
    - 可以把状态的key与其他对象的某些Attribute进行关联，实现状态改变驱动界面元素变化的功能
