# 可视化编辑器设计

所谓可视化编辑，其本质实际上是给设计者一种`所见即所得`的设计体验。提前预览到应用将会表现成的样子，有助于提高设计体验和效率。

**需要注意的是**,所见即所得毕竟只是某种程度上的模拟，和真实环境的效果不可能完全一致，也没用必要投入过多的资源去做到一致。

> 可视化编辑器的目的，一方面是提高设计体验，另外一方面也是通过可视化编辑来替代直接编辑"对象树+属性面板"的方式，来给属性复制

## **效果案例**

本期的可视化设计工具，参考iH5的最终效果，大概是这样的:

![design-tool](./res/design-tool.png)

## **架构设计**

> 由于`ui-designer`的渲染方式和其他可视化编辑系统不同，完全基于独立的布局模型进行渲染，所以不存在用户自定义代码影响框架样式的问题，所以不需要使用iframe进行设计器的隔离

可视化编辑器大概可以由以下部分组成:

- 背景舞台
- 背景标尺系统
- 组件跟踪标尺系统
- 配合每个基础组件的`可视化代理`
- 基本的静态渲染模拟系统

## **设计要点**

### 背景舞台

负责根据页面大小，创建用户进行可视化操作的整体空间。可以考虑模拟PS软件的样式 ，使用白/灰相间的背景来表示此区域真实运行时是不可见的

### 1.背景标尺系统

用来固定显示在背景周围，方便看到具体元素在页面中占据的大致空间

### 2.组件跟踪标尺系统

当拖动`组件代理`的时候，最好可以有一个跟踪标尺动态展示这个组件所在的位置、大小等。

如果做的好，甚至可以智能猜测用户可能希望去`比较`的其他组件代理，展示他们之间的位置、顶部/底部是不是对齐的。（甚至可以有意识去控制拖动位置使得他们更容易像素级别对齐）

### 3.基础组件可视化代理

这个不需要根据每个组件都写一个，最好可以抽象成几大类。

关键的是，为了后期用户自定义组件考虑，这个用户代理需要支持用户自定义渲染逻辑

动画暂时不是必要的，但是以后可以考虑直接在可视化代理里展示组件设定好的动画

### 4.基本的静态渲染模拟系统

这个渲染系统是用来根据配置的`json`参数，动态渲染`可视化代理`的。这个系统的具体实现逻辑有可能会和`h5的引擎`非常类似，但是不需要太过复杂
